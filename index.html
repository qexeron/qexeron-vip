<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>Qexeron | AI Trading Terminal</title>
    
    <meta name="description" content="AI-powered crypto analysis on Qexeron. Free professional charts.">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="6417DFC5-D79B-49EE-BC6C-A89E6BCAD2CE.png" type="image/png">
    <meta name="theme-color" content="#080a0f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preconnect" href="https://s3.tradingview.com">

    <style>
        :root { --bg: #080a0f; --accent: #ffb400; }
        
        body { 
            background: var(--bg); height: 100vh; width: 100vw; 
            overflow: hidden; margin: 0; display: flex; flex-direction: column; 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
        }

        /* ðŸŽ¬ 1. CINEMATIC LOADING ANIMATION */
        #loading-gate { 
            position: fixed; inset: 0; z-index: 9999; 
            background: var(--bg); 
            display: flex; flex-direction: column; 
            align-items: center; justify-content: center; 
            transition: opacity 0.8s ease-out; 
        }
        #loading-gate.hide { opacity: 0; pointer-events: none; }

        /* QEXERON matn animatsiyasi (KIRISH) */
        .q-brand-anim {
            font-size: 42px;
            font-weight: 900;
            color: transparent;
            background: linear-gradient(to right, #fff, var(--accent));
            -webkit-background-clip: text;
            letter-spacing: 2px;
            text-transform: uppercase;
            animation: tracking-in 1.2s cubic-bezier(0.215, 0.610, 0.355, 1.000) both;
            position: relative;
        }
        
        .q-sub-text {
            margin-top: 10px;
            color: rgba(255,255,255,0.4);
            font-size: 10px;
            letter-spacing: 4px;
            text-transform: uppercase;
            animation: fade-up 1.5s ease 0.5s both;
        }

        @keyframes tracking-in {
            0% { letter-spacing: -0.5em; opacity: 0; filter: blur(10px); }
            40% { opacity: 0.6; }
            100% { opacity: 1; filter: blur(0px); letter-spacing: 5px; }
        }
        @keyframes fade-up {
            0% { transform: translateY(20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        /* ðŸ¤– 2. AI BUTTON & MODAL */
        #ai-btn {
            position: fixed; bottom: 110px; /* Pastdagi yozuvdan teparoqqa oldim */
            right: 20px; z-index: 1000;
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: #fff; border: none; width: 55px; height: 55px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 26px; cursor: pointer;
            box-shadow: 0 0 20px rgba(0, 184, 148, 0.5);
            transition: transform 0.2s;
            animation: pulse 2s infinite;
        }
        #ai-btn:active { transform: scale(0.9); }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(0, 184, 148, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(0, 184, 148, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 184, 148, 0); } }

        #ai-modal {
            position: fixed; inset: 0; z-index: 1002;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
        }
        #ai-modal.open { opacity: 1; pointer-events: all; }
        
        .ai-content {
            width: 90%; max-width: 450px; height: 550px;
            background: #131722; border-radius: 20px;
            border: 1px solid rgba(255,180,0,0.2);
            position: relative; overflow: hidden;
            transform: translateY(20px); transition: 0.3s;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        #ai-modal.open .ai-content { transform: translateY(0); }

        .close-ai {
            position: absolute; top: 15px; right: 20px;
            color: rgba(255,255,255,0.5); font-size: 28px; cursor: pointer; z-index: 20;
        }
        
        /* ðŸ”¥ AI Oynasi ichidagi BRENDING */
        .ai-watermark {
            position: absolute; bottom: 0; left: 0; right: 0;
            height: 40px;
            background: linear-gradient(to top, #000, transparent);
            display: flex; align-items: center; justify-content: center;
            z-index: 10; pointer-events: none;
        }
        .ai-watermark span {
            font-weight: 900;
            font-size: 16px;
            letter-spacing: 6px;
            background: linear-gradient(to right, #00b894, #fff);
            -webkit-background-clip: text;
            color: transparent;
            opacity: 0.8;
            text-transform: uppercase;
        }

        /* ðŸ“² INSTALL & SHARE */
        #install-btn { display: none; position: fixed; top: 15px; right: 15px; z-index: 1001; background: rgba(255,180,0,0.15); color: var(--accent); border: 1px solid var(--accent); padding: 6px 14px; border-radius: 8px; font-weight: bold; font-size: 12px; backdrop-filter: blur(5px); }
        
        #share-btn { 
            position: fixed; bottom: 50px; /* Pastdagi yozuvdan teparoqqa oldim */
            left: 50%; transform: translateX(-50%); z-index: 1000; 
            background: #2962ff; color: white; border: none; padding: 12px 35px; border-radius: 50px; font-weight: 800; cursor: pointer; box-shadow: 0 10px 30px rgba(41, 98, 255, 0.4); letter-spacing: 1px; font-size: 13px; 
        }

        /* --- ASOSIY GRAFIK CONTAINER --- */
        #q-terminal { flex: 1; width: 100%; /* Balandlik avtomatik qolgan joyni egallaydi */ }

        /* ðŸ”¥ðŸ”¥ðŸ”¥ YANGI QO'SHILGAN: PASTKI TILLA BREND PANEL ðŸ”¥ðŸ”¥ðŸ”¥ */
        #bottom-brand-bar {
            width: 100%;
            height: 35px; /* Panel balandligi */
            background: var(--bg); /* Grafik foni bilan bir xil */
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid rgba(255, 180, 0, 0.1); /* Juda ingichka tilla chiziq */
            z-index: 900;
        }

        /* TILLA TOVLANADIGAN YOZUV STILI */
        .gold-text-shimmer {
            font-weight: 900;
            font-size: 14px;
            letter-spacing: 4px;
            text-transform: uppercase;
            /* Tilla rang gradienti */
            background: linear-gradient(to right, #a87b00 0%, #ffd700 50%, #a87b00 100%);
            background-size: 200% auto;
            
            /* Matn ichiga rang berish */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
            
            /* Oqish animatsiyasi */
            animation: goldShine 3s linear infinite reverse;
        }

        @keyframes goldShine {
            to { background-position: 200% center; }
        }
        /* -------------------------------------------------- */
        
        /* ðŸ“± MOBIL UCHUN FIX */
        @media (max-width: 768px) {
            .q-brand-anim { font-size: 28px; letter-spacing: 1px; }
            .q-sub-text { font-size: 8px; letter-spacing: 2px; }
            .ai-content { width: 95%; height: 60%; max-height: 500px; }
            
            /* Mobilda tugmalar joylashuvi va pastki panel o'lchami */
            #ai-btn { width: 45px; height: 45px; font-size: 20px; bottom: 105px; right: 15px; }
            #share-btn { bottom: 45px; }
            #bottom-brand-bar { height: 30px; }
            .gold-text-shimmer { font-size: 12px; letter-spacing: 3px; }
        }
    </style>
</head>
<body>

    <div id="loading-gate">
        <div class="q-brand-anim">QEXERON</div>
        <div class="q-sub-text">AI TERMINAL SYSTEMS</div>
    </div>

    <button id="ai-btn" onclick="openAI()">ðŸ¤–</button>

    <div id="ai-modal" onclick="closeAI(event)">
        <div class="ai-content">
            <span class="close-ai" onclick="closeAI(event)">&times;</span>
            
            <div id="technical-analysis-container" style="height: 100%; width: 100%; padding-bottom: 30px;"></div>
            
            <div class="ai-watermark">
                <span>QEXERON</span>
            </div>
        </div>
    </div>

    <button id="install-btn">ðŸ“² INSTALL</button>
    <button id="share-btn" onclick="shareDynamicChart()">SHARE ANALYSIS</button>
    
    <main id="q-terminal"></main>

    <div id="bottom-brand-bar">
        <span class="gold-text-shimmer">QEXERON</span>
    </div>

    <script src="https://s3.tradingview.com/tv.js"></script>
    <script>
        const LAZY_DELAY = 2200; 
        let currentSymbol = "BINANCE:BTCUSDT";

        const urlParams = new URLSearchParams(window.location.search);
        let rawSymbol = urlParams.get('symbol');
        if(rawSymbol) currentSymbol = rawSymbol.includes(':') ? rawSymbol : "BINANCE:" + rawSymbol;

        window.addEventListener('load', () => {
            setTimeout(() => {
                new TradingView.widget({
                    "autosize": true,
                    "symbol": currentSymbol,
                    "interval": "15",
                    "timezone": "Asia/Tashkent",
                    "theme": "dark",
                    "style": "1",
                    "locale": "en",
                    "toolbar_bg": "#080a0f",
                    "enable_publishing": false,
                    "allow_symbol_change": true,
                    "container_id": "q-terminal",
                    "hide_side_toolbar": false,
                    
                    "details": false,  
                    "hotlist": false,  
                    "calendar": false  
                });
                document.getElementById('loading-gate').classList.add('hide');
            }, LAZY_DELAY);
        });

        // ðŸ¤– AI FUNCTION
        function openAI() {
            document.getElementById('ai-modal').classList.add('open');
            document.getElementById('technical-analysis-container').innerHTML = "";
            
            const script = document.createElement("script");
            script.src = "https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js";
            script.async = true;
            script.innerHTML = JSON.stringify({
                "interval": "15m",
                "width": "100%",
                "isTransparent": true, 
                "height": "100%",
                "symbol": currentSymbol,
                "showIntervalTabs": true,
                "displayMode": "single",
                "locale": "en",
                "colorTheme": "dark"
            });
            document.getElementById('technical-analysis-container').appendChild(script);
        }

        function closeAI(e) {
            if (e.target.id === 'ai-modal' || e.target.classList.contains('close-ai')) {
                document.getElementById('ai-modal').classList.remove('open');
            }
        }

        function shareDynamicChart() {
            let symbol = currentSymbol.split(':').pop();
            const link = `https://qexeron.uz/?symbol=${symbol}`;
            const msg = `ðŸš€ Analyzing #${symbol} on Qexeron!\nNo Login. AI Signals.\nCheck here: `;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(msg)}`, '_blank');
        }

        // PWA
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
        let deferredPrompt;
        const installBtn = document.getElementById('install-btn');
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault(); deferredPrompt = e; installBtn.style.display = 'block';
        });
        installBtn.addEventListener('click', () => {
            installBtn.style.display = 'none'; deferredPrompt.prompt();
        });
    </script>
</body>
</html>
